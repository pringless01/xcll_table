// filters.js - global
(function(){
  function createFilterRow(table){ const header=table.rows[0]; if(!header) return; const filterRow=table.insertRow(1); filterRow.className='table-filter-row'; for(let i=0;i<header.cells.length;i++){ const td=filterRow.insertCell(); const input=document.createElement('input'); input.type='text'; input.placeholder=i===0?'🔍 Filtrele':'Filtre'; input.style.cssText='width:100%;box-sizing:border-box;padding:2px 4px;font-size:11px;'; input.addEventListener('input',()=>applyFilter(table)); td.appendChild(input); } }
  function applyFilter(table){ const filterRow=table.querySelector('.table-filter-row'); if(!filterRow) return; const inputs=Array.from(filterRow.querySelectorAll('input')); for(let r=2;r<table.rows.length;r++){ const row=table.rows[r]; if(row.classList.contains('table-total-row')||row.classList.contains('table-grand-total-row')) continue; let visible=true; inputs.forEach((inp,idx)=>{ if(!visible) return; if(!inp.value) return; const cell=row.cells[idx]; if(!cell) return; if(!cell.textContent.toLowerCase().includes(inp.value.toLowerCase())) visible=false; }); row.style.display=visible?'':'none'; } window.ExcelHelperNS.updateAllTableTotals(); }
  function toggleFilters(){ document.querySelectorAll('table').forEach(table=>{ const existing=table.querySelector('.table-filter-row'); if(existing){ existing.remove(); for(let r=1;r<table.rows.length;r++) table.rows[r].style.display=''; } else createFilterRow(table); window.ExcelHelperNS.updateAllTableTotals(); }); }
  window.ExcelHelperNS = window.ExcelHelperNS || {}; Object.assign(window.ExcelHelperNS,{toggleFilters});
})();
